<div class="min-h-screen bg-slate-950 text-white p-6 font-sans">
  <!--   √âtat : EN JEU -->
  @if (store.status() === 'playing') {
  <div class="max-w-md mx-auto space-y-6">
    <!-- Header : Cat√©gorie + Timer -->
    <div class="flex justify-between items-center mb-2">
      <div class="flex items-center gap-3">
        <!-- Petit cercle Timer -->
        <div
          [class]="'w-10 h-10 rounded-full border-2 flex items-center justify-center text-sm font-bold ' + (store.timeLeft() <= 3 ? 'border-red-500 text-red-500' : 'border-blue-500 text-blue-500')"
        >
          {{ store.timeLeft() }}
        </div>
        <div class="text-center">
          <span
            class="text-[8px] uppercase tracking-tighter text-blue-500 font-black"
            >{{ store.currentQuestion().category }}</span
          >
          <p class="text-[10px] text-gray-500 leading-none">
            {{ store.currentIndex() + 1 }}/100
          </p>
        </div>
      </div>

      <div class="bg-white/5 px-3 py-1 rounded-lg border border-white/10">
        <span class="text-[10px] font-bold text-blue-400"
          >Pts: {{ store.score() }}</span
        >
      </div>
    </div>

    <ql-progress-bar
      [current]="store.currentIndex() + 1"
      [total]="100"
      class="mb-4"
    ></ql-progress-bar>

    <!-- La Question -->
    <div
      class="bg-white/5 border border-white/10 p-4 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center"
    >
      <p class="text-base md:text-lg font-bold text-center leading-snug">
        {{ store.currentQuestion().label }}
      </p>
    </div>

    <!-- Les R√©ponses -->
    <div class="grid gap-2">
      @for (option of store.currentQuestion().options; track $index) {
      <button
        (click)="store.answerQuestion($index)"
        class="w-full text-left py-3 px-4 rounded-xl bg-white/5 border border-white/10 active:bg-blue-600 transition-all"
      >
        <div class="flex items-center gap-3">
          <span
            class="w-6 h-6 rounded-md bg-white/10 flex items-center justify-center text-[10px] font-black"
          >
            {{ ['A', 'B', 'C', 'D'][$index] }}
          </span>
          <span class="text-sm font-medium">{{ option }}</span>
        </div>
      </button>
      }
    </div>
  </div>
  }

  <!-- √âTAT : PAUSE DE SURVIE -->
  <!-- √âTAT : PAUSE DE SURVIE (Optimis√© Mobile 320px) -->
  @if (store.status() === 'break') {
  <div
    class="min-h-[100dvh] flex flex-col items-center justify-between p-4 text-center animate-fadeIn bg-slate-950"
  >
    <!-- HEADER COMPACT -->
    <div class="mt-4">
      <div
        class="inline-block px-3 py-0.5 rounded-full bg-blue-500/20 text-blue-400 text-[9px] font-black uppercase tracking-widest mb-2 border border-blue-500/30"
      >
        Palier {{ store.currentIndex() / 25 }} / 4 Atteint
      </div>
      <h1
        class="text-3xl font-black italic tracking-tighter uppercase leading-none"
      >
        PAUSE DE <span class="text-blue-500 text-4xl block">SURVIE</span>
      </h1>
    </div>

    <!-- CARTE DE SCORE (Tass√©e) -->
    <div
      class="w-full bg-white/5 border border-white/10 rounded-[2rem] p-5 backdrop-blur-md shadow-2xl"
    >
      <!-- Indicateur de progression visuelle (4 blocs) -->
      <div class="flex gap-1 mb-6">
        @for (i of [1,2,3,4]; track i) {
        <div
          [class]="'h-1.5 flex-1 rounded-full ' + (store.currentIndex() >= i*25 ? 'bg-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.5)]' : 'bg-white/10')"
        ></div>
        }
      </div>

      <div class="grid grid-cols-2 gap-2 mb-6">
        <div class="border-r border-white/10">
          <p class="text-2xl font-black leading-none">
            {{ store.currentIndex() }}
          </p>
          <p
            class="text-[9px] text-gray-500 uppercase font-bold tracking-tighter"
          >
            Questions
          </p>
        </div>
        <div>
          <p class="text-2xl font-black text-blue-500 leading-none">
            {{ store.score() }}
          </p>
          <p
            class="text-[9px] text-gray-500 uppercase font-bold tracking-tighter"
          >
            Buteurs
          </p>
        </div>
      </div>

      <p class="text-xs text-gray-300 italic leading-snug mb-6 px-2">
        "Le talent ne suffit pas. C'est l'endurance qui fera de toi
        <span class="text-white font-bold uppercase">L'OOTAKU</span>."
      </p>

      <ql-button (clicked)="store.resumeQuiz()">
        CONTINUER LE MARATHON
      </ql-button>
    </div>

    <!-- TEASING (Tr√®s discret en bas) -->
    <!-- <div class="mb-4">
      <p class="text-[9px] text-gray-500 font-bold uppercase tracking-widest leading-tight">
        Fatigu√© ? <span class="text-blue-600">Pass Premium (500 FCFA)</span><br/>
        <span class="opacity-40 italic">Jokers & Temps bonus bient√¥t disponibles</span>
      </p>
    </div> -->
    <!-- Dans l'√©cran de BREAK, remplace la partie teasing par ceci : -->
    <div
      (click)="openPremiumModal()"
      class="mb-4 cursor-pointer group active:scale-95 transition-transform"
    >
      <p
        class="text-[9px] text-gray-500 font-bold uppercase tracking-widest leading-tight group-hover:text-blue-400 transition-colors"
      >
        Fatigu√© ?
        <span class="text-blue-600 underline">D√©couvre le Pass Premium</span
        ><br />
        <span class="opacity-40 italic"
          >Clique pour voir les avantages exclusifs</span
        >
      </p>
    </div>
  </div>
  }

  <!-- √âtat : GAME OVER (R√©sultats) -->
  @if (store.status() === 'game-over') {
  <div
    class="min-h-screen flex flex-col items-center justify-center p-4 text-center animate-fadeIn"
  >
    <!-- TITRE COMPACT -->
    <div class="mb-4">
      <h1
        class="text-4xl font-black italic tracking-tighter uppercase leading-none"
      >
        MISSION <span class="text-blue-500">TERMIN√âE</span>
      </h1>
      <p
        class="text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-2"
      >
        Score final enregistr√©
      </p>
    </div>

    <!-- SCORE CARD (R√©duite pour mobile) -->
    <div
      class="w-full bg-blue-600 rounded-[2.5rem] p-8 shadow-2xl shadow-blue-500/20 relative overflow-hidden mb-4"
    >
      <div class="relative z-10">
        <p
          class="text-[10px] uppercase font-black text-blue-200 mb-1 tracking-widest"
        >
          Ton Potentiel
        </p>
        <p class="text-7xl font-black leading-none">{{ store.score() }}</p>
        <p class="text-blue-200 text-xs mt-2 font-bold uppercase">
          sur {{ store.questions().length }} points
        </p>
      </div>
      <div
        class="absolute -bottom-6 -right-6 w-24 h-24 bg-white/10 rounded-full blur-2xl"
      ></div>
    </div>

    <!-- NOUVEAU : SECTION R√âSEAUX & CR√âDITS (Compacte) -->
    <div class="grid grid-cols-2 gap-2 w-full mb-6">
      <a
        href="https://www.linkedin.com/in/erasme-mayetela-üì±üóÉ-b6229a209/"
        target="_blank"
        class="flex items-center justify-center gap-2 bg-white/5 border border-white/10 py-3 rounded-xl hover:bg-blue-500/20 transition-all"
      >
        <span class="text-[10px] font-black uppercase text-gray-400"
          >By Erasme (Dev)</span
        >
      </a>
      <a
        href="https://chat.whatsapp.com/D1r3pRZoiHc0E9WpIpzetW"
        target="_blank"
        class="flex items-center justify-center gap-2 bg-white/5 border border-white/10 py-3 rounded-xl hover:bg-orange-500/20 transition-all"
      >
        <span class="text-[10px] font-black uppercase text-gray-400"
          >Commu Afrotaku</span
        >
      </a>
    </div>

    <!-- ACTIONS PRINCIPALES -->
    <div class="w-full space-y-3">
      <!-- Bouton WhatsApp (Le plus important pour la viralit√©) -->
      <button
        (click)="shareOnWhatsApp()"
        class="w-full bg-[#25D366] text-white font-black py-4 rounded-2xl flex items-center justify-center gap-3 shadow-lg active:scale-95 transition-all text-sm tracking-widest"
      >
        <span>üì≤ PARTAGER LE D√âFI</span>
      </button>

      <!-- Grille Rejouer / Rang -->
      <div class="grid grid-cols-2 gap-3">
        <button
          (click)="store.reset(); store.startQuiz()"
          class="bg-white text-black font-black py-4 rounded-2xl text-xs uppercase tracking-widest active:scale-95 transition-all"
        >
          REJOUER
        </button>
        <button
          (click)="showLeaderboard.emit()"
          class="bg-transparent border border-white/20 text-white font-black py-4 rounded-2xl text-xs uppercase tracking-widest active:scale-95 transition-all"
        >
          üèÜ RANG
        </button>
      </div>
    </div>
  </div>
  }

  <!-- MODALE PREMIUM (S'affiche par dessus tout) -->
  @if (isPremiumModalOpen()) {
  <div
    class="fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-4 animate-fadeIn"
  >
    <!-- Background Blur -->
    <div
      class="absolute inset-0 bg-slate-950/90 backdrop-blur-md"
      (click)="isPremiumModalOpen.set(false)"
    ></div>

    <!-- Carte Modale -->
    <div
      class="relative w-full max-w-sm bg-slate-900 border border-blue-500/30 rounded-[2.5rem] p-8 shadow-[0_0_50px_rgba(59,130,246,0.2)] overflow-hidden"
    >
      <!-- Effet de brillance en fond -->
      <div
        class="absolute -top-22 -right-24 w-48 h-48 bg-blue-600/20 rounded-full blur-3xl"
      ></div>

      <div class="text-center space-y-6">
        <div
          class="inline-block px-4 py-1 rounded-full bg-blue-500 text-white text-[8px] font-black uppercase tracking-widest"
        >
          PROJET QUIZ LOCK : √âLITE
        </div>

        <h2
          class="text-2xl font-black italic tracking-tighter uppercase leading-none"
        >
          DEVENEZ UNE <br />
          <span class="text-blue-500 text-2xl">L√âGENDE.</span>
        </h2>

        <ul class="text-left space-y-4 py-4">
          <li class="flex items-center gap-3 text-sm">
            <span class="text-blue-500">‚úî</span>
            <span class="text-gray-300 font-medium"
              >Z√©ro Publicit√© (Focus Total)</span
            >
          </li>
          <li class="flex items-center gap-3 text-sm">
            <span class="text-blue-500">‚úî</span>
            <span class="text-gray-300 font-medium"
              >Th√®mes Exclusifs (Hardcore)</span
            >
          </li>
          <li class="flex items-center gap-3 text-sm">
            <span class="text-blue-500">‚úî</span>
            <span class="text-gray-300 font-medium"
              >Jokers de Survie (Temps bonus)</span
            >
          </li>
          <li class="flex items-center gap-3 text-sm">
            <span class="text-blue-500">‚úî</span>
            <span class="text-gray-300 font-medium"
              >Badge "√âlite" au classement</span
            >
          </li>
        </ul>

        <div class="bg-white/5 rounded-2xl p-4 border border-white/5">
          <p class="text-[10px] text-gray-500 uppercase font-bold mb-1">
            Tarif Unique
          </p>
          <p class="text-2xl font-black text-white">
            500 FCFA
            <span class="text-xs text-gray-400 font-normal">/ mois</span>
          </p>
        </div>

        <button
          (click)="isPremiumModalOpen.set(false)"
          class="w-full bg-blue-600 text-white font-black py-4 rounded-xl shadow-lg active:scale-95 transition-all uppercase tracking-widest text-xs"
        >
          Bient√¥t disponible
        </button>

        <button
          (click)="isPremiumModalOpen.set(false)"
          class="text-[10px] text-gray-600 uppercase font-bold tracking-widest hover:text-white"
        >
          Retour au marathon
        </button>
      </div>
    </div>
  </div>
  }
</div>
