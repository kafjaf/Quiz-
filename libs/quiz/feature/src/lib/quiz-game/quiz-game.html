<div class="min-h-screen bg-slate-950 text-white p-6 font-sans">
  <!--   État : EN JEU -->
  @if (store.status() === 'playing') {
  <div class="max-w-md mx-auto space-y-6">
    <!-- Header : Catégorie + Timer -->
    <div class="flex justify-between items-center mb-2">
      <div class="flex items-center gap-3">
        <!-- Petit cercle Timer -->
        <div
          [class]="'w-10 h-10 rounded-full border-2 flex items-center justify-center text-sm font-bold ' + (store.timeLeft() <= 3 ? 'border-red-500 text-red-500' : 'border-blue-500 text-blue-500')"
        >
          {{ store.timeLeft() }}
        </div>
        <div class="text-center">
          <span
            class="text-[8px] uppercase tracking-tighter text-blue-500 font-black"
            >{{ store.currentQuestion().category }}</span
          >
          <p class="text-[10px] text-gray-500 leading-none">
            {{ store.currentIndex() + 1 }}/100
          </p>
        </div>
      </div>

      <div
        class="bg-white/5 px-3 py-1 rounded-lg border border-white/10 flex items-center gap-2"
      >
        <lucide-icon
          name="target"
          class="w-3.5 h-3.5 text-blue-400"
          [strokeWidth]="2.5"
        ></lucide-icon>
        <span class="text-[13px] font-bold text-blue-400 italic uppercase tracking-tighter" 
          >Pts: {{ store.score() }}</span
        >
      </div>
    </div>

    <ql-progress-bar
      [current]="store.currentIndex() + 1"
      [total]="100"
      class="mb-4"
    ></ql-progress-bar>

    <!-- La Question -->
    <div
      class="bg-white/5 border border-white/10 p-4 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center"
    >
      <p class="text-base md:text-lg font-bold text-center leading-snug">
        {{ store.currentQuestion().label }}
      </p>
    </div>

    <!-- Les Réponses -->
    <div class="grid gap-2">
      @for (option of store.currentQuestion().options; track $index) {
      <button
        (click)="store.answerQuestion($index)"
        class="w-full text-left py-3 px-4 rounded-xl bg-white/5 border border-white/10 active:bg-blue-600 transition-all"
      >
        <div class="flex items-center gap-3">
          <span
            class="w-6 h-6 rounded-md bg-white/10 flex items-center justify-center text-[10px] font-black"
          >
            {{ ['A', 'B', 'C', 'D'][$index] }}
          </span>
          <span class="text-sm font-medium">{{ option }}</span>
        </div>
      </button>
      }
    </div>
  </div>
  }

  <!-- ÉTAT : PAUSE DE SURVIE (Optimisé Mobile 320px) -->
  @if (store.status() === 'break') {
  <div
    class="min-h-[100dvh] flex flex-col items-center justify-between p-4 text-center animate-fadeIn bg-slate-950"
  >
    <!-- HEADER COMPACT -->
    <div class="mt-4">
      <div
        class="inline-block px-3 py-0.5 rounded-full bg-blue-500/20 text-blue-400 text-[10px] font-black uppercase tracking-widest mb-2 border border-blue-500/30"
      >
        Palier {{ store.currentIndex() / 25 }} / 4 Atteint
      </div>
      <h1
        class="text-2xl font-black italic tracking-tighter uppercase leading-none"
      >
        PAUSE DE <span class="text-blue-500 text-3xl block">SURVIE</span>
      </h1>
    </div>

    <!-- CARTE DE SCORE (Tassée) -->
    <div
      class="w-full bg-white/5 border border-white/10 rounded-[2rem] p-5 backdrop-blur-md shadow-2xl"
    >
      <!-- Indicateur de progression visuelle (4 blocs) -->
      <div class="flex gap-1 mb-6">
        @for (i of [1,2,3,4]; track i) {
        <div
          [class]="'h-1.5 flex-1 rounded-full ' + (store.currentIndex() >= i*25 ? 'bg-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.5)]' : 'bg-white/10')"
        ></div>
        }
      </div>

      <div class="grid grid-cols-2 gap-2 mb-6">
        <div class="border-r border-white/10">
          <p class="text-2xl font-black leading-none">
            {{ store.currentIndex() }}
          </p>
          <p
            class="text-[9px] text-gray-500 uppercase font-bold tracking-tighter"
          >
            Questions
          </p>
        </div>
        <div>
          <p class="text-2xl font-black text-blue-500 leading-none">
            {{ store.score() }}
          </p>
          <p
            class="text-[9px] text-gray-500 uppercase font-bold tracking-tighter"
          >
            Buts
          </p>
        </div>
      </div>

      <p class="text-xs text-gray-300 italic leading-snug mb-6 px-2">
        "Le talent ne suffit pas. C'est l'endurance qui fera de toi
        <span class="text-white font-bold uppercase">L'OOTAKU</span>."
      </p>

      <ql-button (clicked)="store.resumeQuiz()">
        CONTINUER LE MARATHON
      </ql-button>
    </div>

    <!-- Dans l'écran de BREAK, remplace la partie teasing par ceci : -->
    <div
      (click)="openPremiumModal()"
      class="mb-4 cursor-pointer group active:scale-95 transition-transform"
    >
      <p
        class="text-[9.5px] text-gray-500 font-bold uppercase tracking-widest leading-tight group-hover:text-blue-400 transition-colors"
      >
        <lucide-icon
          name="gem"
          class="w-3 h-3 inline-block mr-1 mb-1"
        ></lucide-icon>
        Fatigué ?
        <span class="text-blue-600 underline">Découvre le Pass Premium</span
        ><br />
        <span class="opacity-60 italic"
          >Clique pour voir les avantages exclusifs</span
        >
      </p>
    </div>
  </div>
  }

  <!-- État : GAME OVER (Résultats) -->
  @if (store.status() === 'game-over') {
  <div
    class="min-h-screen flex flex-col items-center justify-center p-4 text-center animate-fadeIn font-sans"
  >
    <!-- 1. TITRE ET SCORE -->
    <div class="mb-6">
      <h1
        class="text-2xl font-black italic tracking-tighter uppercase leading-none"
      >
        MISSION <span class="text-blue-500">TERMINÉE</span>
      </h1>
      <div
        class="mt-4 bg-blue-600 rounded-[2rem] p-6 shadow-2xl shadow-blue-500/20 relative overflow-hidden"
      >
        <p
          class="text-[9px] uppercase font-black text-blue-200 mb-1 tracking-[0.2em]"
        >
          Potentiel Débloqué
        </p>
        <p class="text-3xl font-black leading-none">{{ store.score() }}/100</p>
        <lucide-icon
          name="crown"
          class="absolute -bottom-2 -right-2 w-20 h-20 text-white opacity-10 rotate-12"
        ></lucide-icon>
      </div>
    </div>

    <!-- 2. SECTION ÉLITE (Toi + Afrotaku) -->
    <div class="w-full grid grid-cols-2 gap-3 mb-8">
      <!-- LinkedIn (Ton branding) -->
      <a
        href="https://www.linkedin.com/in/erasme-mayetela-b6229a209/"
        target="_blank"
        class="flex flex-col items-center gap-2 bg-white/5 border border-blue-500/20 p-3 rounded-2xl active:scale-95 transition-all"
      >
        <div class="bg-blue-600/20 p-2 rounded-lg">
          <lucide-icon
            name="linkedin"
            class="w-4 h-4 text-blue-400"
          ></lucide-icon>
        </div>
        <span
          class="text-[9px] font-black uppercase tracking-widest text-gray-300"
          >L'Architecte</span
        >
      </a>

      <!-- Afrotaku (La Communauté) -->
      <a
        href="https://chat.whatsapp.com/D1r3pRZoiHc0E9WpIpzetW"
        target="_blank"
        class="flex flex-col items-center gap-2 bg-white/5 border border-orange-500/20 p-3 rounded-2xl active:scale-95 transition-all"
      >
        <div class="bg-orange-500/20 p-2 rounded-lg">
          <lucide-icon
            name="users"
            class="w-4 h-4 text-orange-400"
          ></lucide-icon>
        </div>
        <span
          class="text-[9px] font-black uppercase tracking-widest text-gray-300"
          >Le Clan</span
        >
      </a>
    </div>

    <!-- 3. GRILLE DE PROPAGANDE (Partage) -->
   <div class="w-full mb-8">
  <p class="text-[10px] font-black uppercase tracking-[0.3em] text-gray-500 mb-4 italic">
    Propager le défi
  </p>
  
  <!-- Passage à 3 colonnes pour un équilibre parfait -->
  <div class="grid grid-cols-3 gap-3">
    
    <!-- WhatsApp (Le roi du partage au Congo) -->
    <button (click)="shareOnWhatsApp()" class="flex flex-col items-center gap-2 active:scale-95 transition-all">
      <div class="w-full aspect-square bg-[#25D366]/10 border border-[#25D366]/20 rounded-xl flex items-center justify-center">
        <lucide-icon name="message-circle" class="w-6 h-6 text-[#25D366]"></lucide-icon>
      </div>
      <span class="text-[8px] font-bold text-gray-500 uppercase tracking-widest">WhatsApp</span>
    </button>

    <!-- Facebook (Très utilisé également) -->
    <button (click)="shareOnFB()" class="flex flex-col items-center gap-2 active:scale-95 transition-all">
      <div class="w-full aspect-square bg-[#1877F2]/10 border border-[#1877F2]/20 rounded-xl flex items-center justify-center">
        <lucide-icon name="facebook" class="w-6 h-6 text-[#1877F2]"></lucide-icon>
      </div>
      <span class="text-[8px] font-bold text-gray-500 uppercase tracking-widest">Facebook</span>
    </button>

    <!-- Native Share (Toutes les autres options) -->
    <button (click)="nativeShare()" class="flex flex-col items-center gap-2 active:scale-95 transition-all">
      <div class="w-full aspect-square bg-white/5 border border-white/10 rounded-xl flex items-center justify-center">
        <lucide-icon name="share-2" class="w-6 h-6 text-white"></lucide-icon>
      </div>
      <span class="text-[8px] font-bold text-gray-500 uppercase tracking-widest">Autres</span>
    </button>

  </div>
</div>
    <!-- 4. ACTIONS DE JEU -->
    <div class="w-full flex gap-3">
      <button
        (click)="store.reset(); store.startQuiz()"
        class="flex-1 bg-white text-black font-black py-4 rounded-xl text-xs uppercase tracking-widest active:scale-95 transition-all"
      >
        REJOUER
      </button>
      <button
        (click)="showLeaderboard.emit()"
        class="flex-1 bg-white/5 border border-white/10 text-white font-black py-4 rounded-xl text-[10px] uppercase tracking-[0.2em] flex items-center justify-center gap-2 active:scale-95 active:bg-white/10 transition-all group"
      >
        <!-- L'icône remplace l'émoji -->
        <lucide-icon
          name="bar-chart-3"
          class="w-4 h-4 text-blue-500 group-active:text-white transition-colors"
          [strokeWidth]="2"
        >
        </lucide-icon>

        <span>MON RANG</span>
      </button>
    </div>
  </div>
  }
  

  <!-- MODALE PREMIUM (S'affiche par dessus tout) -->
  @if (isPremiumModalOpen()) {
  <div
    class="fixed inset-0 z-[100] flex items-end justify-center p-4 animate-fadeIn"
  >
    <div
      class="absolute inset-0 bg-slate-950/90 backdrop-blur-md"
      (click)="isPremiumModalOpen.set(false)"
    ></div>
    <div
      class="relative w-full max-w-sm bg-slate-900 border border-blue-500/30 rounded-[2.5rem] p-8 shadow-[0_0_50px_rgba(59,130,246,0.2)] overflow-hidden"
    >
      <div class="text-center space-y-6">
        <div
          class="inline-block px-4 py-1 rounded-full bg-blue-500 text-white text-[8px] font-black uppercase tracking-widest"
        >
          STATUT : ÉLITE
        </div>
        <h2
          class="text-2xl font-black italic tracking-tighter uppercase leading-none"
        >
          DEVENEZ UNE <br /><span class="text-blue-500 text-2xl">LÉGENDE.</span>
        </h2>
        <ul class="text-left space-y-4 py-4">
          <li class="flex items-center gap-3 text-sm">
            <lucide-icon name="zap" class="w-4 h-4 text-blue-500"></lucide-icon>
            <span class="text-gray-300 font-medium"
              >Zéro Publicité (Focus Total)</span
            >
          </li>
          <li class="flex items-center gap-3 text-sm">
            <lucide-icon
              name="crown"
              class="w-4 h-4 text-blue-500"
            ></lucide-icon>
            <span class="text-gray-300 font-medium"
              >Thèmes Exclusifs (Hardcore)</span
            >
          </li>
          <li class="flex items-center gap-3 text-sm">
            <lucide-icon
              name="timer"
              class="w-4 h-4 text-blue-500"
            ></lucide-icon>
            <span class="text-gray-300 font-medium"
              >Jokers de Survie (Temps bonus)</span
            >
          </li>
        </ul>
        <div class="bg-white/5 rounded-2xl p-4 border border-white/5">
          <p class="text-[10px] text-gray-500 uppercase font-bold mb-1">
            Tarif Unique
          </p>
          <p class="text-2xl font-black text-white italic">
            500 FCFA
            <span class="text-xs text-gray-400 font-normal">/ mois</span>
          </p>
        </div>
        <button
          (click)="isPremiumModalOpen.set(false)"
          class="w-full bg-blue-600 text-white font-black py-4 rounded-xl uppercase tracking-widest text-xs"
        >
          Bientôt disponible
        </button>
      </div>
    </div>
  </div>
  }
</div>
